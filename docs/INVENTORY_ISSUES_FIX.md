# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Inventory

## üîç **‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö**

### 1. ‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢(‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡∏•‡∏≤‡∏á) ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `-` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: material_id ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô BOM ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏ô database `default_itemvalue`

**Material IDs ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤**:
- 8 (‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡∏•‡πà‡∏≤)
- 16 (‡∏´‡∏°‡∏π‡∏ö‡∏î - CT)
- 17 (‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏á‡∏≤ ‡∏ï‡∏£‡∏≤‡∏°‡∏±‡∏á‡∏Å‡∏£‡∏Ñ‡∏π‡πà)
- 18 (‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏¥‡∏û‡∏¢‡πå‡∏ã‡∏≠‡∏á)
- 19 (‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ó‡∏£‡∏≤‡∏¢‡∏Ç‡∏≤‡∏ß‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå)
- 20 (‡πÅ‡∏õ‡πâ‡∏á‡∏°‡∏±‡∏ô‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á)
- 21 (‡∏ú‡∏á‡∏ü‡∏π)
- 22 (‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢‡∏Ç‡∏≤‡∏ß‡∏õ‡πà‡∏ô)
- 39 (‡∏´‡∏°‡∏π‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á - FG)

**Material IDs ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤**:
- 105001 (‡∏Å‡∏∏‡πâ‡∏á 36-40 ‡∏ï‡∏±‡∏ß/‡∏Å‡∏Å.) - ‡∏ø240.00
- 105002 (‡∏Å‡∏∏‡πâ‡∏á 120 ‡∏ï‡∏±‡∏ß/‡∏Å‡∏Å.) - ‡∏ø140.00
- 105004 (‡πÑ‡∏Ç‡πà‡∏´‡∏°‡∏∂‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢) - ‡∏ø120.00
- 105005 (‡∏õ‡∏π‡∏Å‡∏∞‡∏ï‡∏≠‡∏¢ 500‡∏Å‡∏£‡∏±‡∏°) - ‡∏ø167.00
- 105006 (‡∏õ‡∏•‡∏≤‡πÑ‡∏Ç‡πà 70 ‡∏ï‡∏±‡∏ß/‡∏Å‡∏Å) - ‡∏ø178.00
- 105007 (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≠‡∏¢‡πÅ‡∏°‡∏•‡∏á‡∏†‡∏π‡πà) - ‡∏ø99.00

### 2. Type ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `I` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: Code ‡πÉ‡∏ä‡πâ `{field.is_fg ? 'I' : 'M'}` ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô `'O'` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö

### 3. ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ã‡πâ‡∏≥
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ‡πÉ‡∏ä‡πâ `{selectedWorkplanObj ? index + 2 : index + 1}` ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ã‡πâ‡∏≥

## ‚úÖ **‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥**

### 1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Price Loading Logic
```javascript
// ‚ùå ‡πÄ‡∏î‡∏¥‡∏°
useEffect(() => {
    const mats = (fields || []).map((f, idx) => ({
        material_id: f.material_id,
        unit: f.unit
    }));
    loadLatestPricesForMaterials(mats);
}, [fields.length]);

// ‚úÖ ‡πÉ‡∏´‡∏°‡πà
useEffect(() => {
    const materialIds = (fields || [])
        .map(f => f.material_id)
        .filter(id => id && Number.isFinite(id));
    
    if (materialIds.length > 0) {
        loadLatestPricesForMaterials(materialIds);
    }
}, [fields.map(f => f.material_id).join(',')]);
```

### 2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Type Display
```javascript
// ‚ùå ‡πÄ‡∏î‡∏¥‡∏°
{field.is_fg ? 'I' : 'M'}

// ‚úÖ ‡πÉ‡∏´‡∏°‡πà
{field.is_fg ? 'I' : 'O'}
```

### 3. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡∏≥‡∏î‡∏±‡∏ö
```javascript
// ‚ùå ‡πÄ‡∏î‡∏¥‡∏°
{selectedWorkplanObj ? index + 2 : index + 1}

// ‚úÖ ‡πÉ‡∏´‡∏°‡πà
{index + 1}
```

### 4. ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Price Display Logic
```javascript
// ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤
{(() => {
    const p = latestPrices[field.material_id];
    if (!p) return '-';
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤
    let price = p.price_per_unit;
    if (p.display_unit !== field.unit) {
        // ‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢
        price = p.price_per_base_unit * (p.display_to_base_rate || 1);
    }
    
    return formatCurrency(Number(price || 0));
})()}
```

### 5. ‡πÄ‡∏û‡∏¥‡πà‡∏° Debug Logging
```javascript
console.log('Loading prices for material_ids:', ids);
console.log('Loaded prices:', map);
```

## üéØ **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**

### ‚úÖ **‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ**
- Type ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `O` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö, `I` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö FG
- ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ (1, 2, 3, 4, 5, 6)
- Price loading logic ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏°‡∏µ debug logging ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

### ‚ö†Ô∏è **‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ**
- ‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢(‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡∏•‡∏≤‡∏á) ‡∏¢‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `-` ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ material_id ‡πÉ‡∏ô BOM ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏ô database `default_itemvalue`

## üîß **‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤**

### ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 1: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏ô database `default_itemvalue`
```sql
INSERT INTO default_itemvalue.default_itemvalue 
(material_id, material_name, display_unit, base_unit, price_per_unit, currency, effective_date)
VALUES 
(8, '‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏Å‡∏Å.', '‡∏Å‡∏Å.', 0.00, 'THB', NOW()),
(16, '‡∏´‡∏°‡∏π‡∏ö‡∏î - CT', '‡∏Å‡∏Å.', '‡∏Å‡∏Å.', 120.00, 'THB', NOW()),
(17, '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏á‡∏≤ ‡∏ï‡∏£‡∏≤‡∏°‡∏±‡∏á‡∏Å‡∏£‡∏Ñ‡∏π‡πà', '‡∏Å‡∏Å.', '‡∏Å‡∏Å.', 85.00, 'THB', NOW()),
-- ... ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö material_id ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
```

### ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 2: ‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á `material` ‡πÉ‡∏ô `esp_tracker`
```javascript
// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç BOM query ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á material
const bomSql = `
    SELECT DISTINCT
        fb.Raw_Code,
        fb.Raw_Qty,
        fb.FG_Code,
        m.id as material_id,
        m.Mat_Name,
        m.Mat_Unit,
        COALESCE(m.price, 0) as price,  // ‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á material
        0 as is_fg
    FROM fg_bom fb
    JOIN material m ON fb.Raw_Code COLLATE utf8mb4_unicode_ci = m.Mat_Id COLLATE utf8mb4_unicode_ci
    WHERE fb.FG_Code = ?
`;
```

## üìÅ **‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç**

1. **frontend/src/pages/InventoryData.js**
   - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç price loading logic
   - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Type display
   - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡∏≥‡∏î‡∏±‡∏ö
   - ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á price display logic
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° debug logging

## üß™ **‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö**

1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ http://localhost:3014/adminOperation/inventory
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ BOM
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:
   - Type ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `O` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö
   - ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
   - ‡πÄ‡∏õ‡∏¥‡∏î Console (F12) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π debug logs
   - ‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢(‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡∏•‡∏≤‡∏á) ‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô `-` (‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô database)
